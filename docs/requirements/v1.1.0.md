# Project Master Eyes Requirements

## Version

1.1.0

## Game Name

Master Eyes

## New Feature: Supabase Leaderboard Integration

### Overview

Players can now submit their winning scores to a Supabase backend, creating a persistent leaderboard. Players can also view the leaderboard from the main menu.

### Game Play (Unchanged from v1.0.0)

All gameplay mechanics remain the same as v1.0.0.

### New Functionality

#### Main Menu Updates

The main menu now provides two options:
1. **Play Game** - Board size selection (3x3 to 8x8) as before
2. **Leaderboard** - New option to view top scores

#### Score Submission (Win Scenario Only)

When a player successfully completes all tiles in the correct sequence:
1. Display result modal as before
2. Show text input field for player name
3. Show "Submit Score" button
4. Show "Skip" button to return to main menu without submitting

**Name Input Field Requirements:**
- Label: "Enter your name"
- Placeholder: "Your name"
- Maximum: 50 characters
- Minimum: 1 character (non-empty, trimmed)
- Styled to match dark theme with accent colors
- Disabled during submission

**Submit Score Button:**
- Disabled when name is empty or submission in progress
- Shows loading state during submission
- On success: returns to menu
- On failure: shows snackbar error, allows retry

**Skip Button:**
- Immediately returns to main menu without API call

**Game Over Scenario:**
- Unchanged from v1.0.0 - no score submission offered

#### Leaderboard Display

Accessible from main menu:
- Shows top scores sorted by completion time (fastest first)
- Displays: player name, board size, completion time
- Styled to match current dark theme

#### Error Handling

- Failed submissions display a **snackbar** at bottom of screen
- Snackbar shows error message
- "Retry" button in snackbar allows resubmission
- Snackbar auto-dismisses after success or manual dismissal

### Supabase Table Schema

Table name: `speed_tiles`

| Column | Type | Constraints | Description |
|--------|------|-------------|-------------|
| id | UUID | PRIMARY KEY, auto-generated | Unique identifier |
| player_name | TEXT | NOT NULL, max 50 chars | Player's submitted name |
| board_size | INTEGER | NOT NULL (3-8) | Size of the board |
| completion_time_ms | INTEGER | NOT NULL, > 0 | Time in milliseconds |
| created_date | TIMESTAMPTZ | DEFAULT NOW() | Timestamp of submission |

### Technical Requirements

1. **Environment Variables:**
   - `VITE_SUPABASE_URL` - Supabase project URL
   - `VITE_SUPABASE_ANON_KEY` - Supabase anon key

2. **Client-side Validation:**
   - Name: 1-50 characters, trimmed
   - Board size: validated (3-8)
   - Completion time: > 0

3. **RLS Policies:**
   - Anonymous inserts allowed (score submission)
   - Public read allowed (leaderboard display)

4. **Error Handling:**
   - Network errors show snackbar with retry option
   - Graceful degradation if Supabase unavailable
